{% extends "base.html" %}
{% set title = "Admin Login" %}

{% block content %}
<div class="page-header">
  <h1>Admin Login</h1>
  <p>Admins only.</p>
</div>

<div class="content-card" style="max-width:420px;">
  <div id="msg"></div>

  <div class="form-group">
    <label>Username</label>
    <input id="username" autocomplete="username">
  </div>
  <div class="form-group">
    <label>Password</label>
    <input id="password" type="password" autocomplete="current-password">
  </div>

  <button class="btn" id="loginBtn">Login</button>
</div>
{% endblock %}

{% block scripts %}
<script>
function show(type, text){
  document.getElementById("msg").innerHTML = `<div class="message message-${type}">${text}</div>`;
}

document.getElementById("loginBtn").onclick = async () => {
  const username = document.getElementById("username").value.trim();
  const password = document.getElementById("password").value;

  const res = await fetch("/api/login", {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({ username, password })
  });

  const data = await res.json().catch(()=> ({}));
  if (res.ok && data.success) {
    window.location.href = "/admin/inventory";
  } else {
    show("error", data.error || "Login failed");
  }
};
</script>
{% endblock %}
